#!/bin/bash

# Task 1: Extract PokÃ©mon Data
# Using only jq, awk, sed as required

INPUT_FILE="data.json"

# Check if file exists
if [[ ! -f "$INPUT_FILE" ]]; then
    echo "Error: $INPUT_FILE not found" >&2
    exit 1
fi

# Extract and format in one pipeline
jq -r '. | "\(.name)|\(.height)|\(.weight)|\(.types[0].type.name)"' "$INPUT_FILE" 2>/dev/null | \
awk -F'|' '{
    name = $1
    height = $2
    weight = $3
    type = $4
    
    # Convert height from decimeters to meters
    formatted_height = height / 10
    
    # Convert weight from hectograms to kilograms  
    formatted_weight = weight / 10
    
    # Format exactly as required
    printf "%s is of type %s, weighs %dkg, and is %.1fm tall.\n", 
           name, type, formatted_weight, formatted_height
}'

#Elghamour version
# A script that uses advanced text manipulation tools (jq, awk, sed) to extract specific data from the API response in data.json

# 1. Extract name, height, weight, type from the json data and store it in variables
# js treats the input as json objects
name=$(jq -r '.name' data.json)
height=$(jq -r '.height' data.json)
weight=$(jq -r '.weight' data.json)
type=$(jq -r '.types[0].type.name' data.json)


# 2. Use awk to to turn height from dm to meter and weight from hg to kg
formatted_height=$(echo "$height" | awk '{print $1 / 10}')
formatted_weight=$(echo "$weight" | awk '{print $1 / 10}')

# 3. Use awk to capitalize the first letters of the name and type
name=$(echo "$name" | awk '{$1=toupper(substr($1,1,1)) substr($1,2); print $0}')
type=$(echo "$type" | awk '{$1=toupper(substr($1,1,1)) substr($1,2); print $0}')

# 4. Print out the message
echo "$name is of type $type, weighs ${formatted_weight}kg, and is ${formatted_height}m tall."